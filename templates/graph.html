<!DOCTYPE html>
<html>
<head>
	<title>Graph</title>
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
	<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
	<form method="post" action="/">
        <label for="page">Sélectionner une page :</label>
        <select name="page" id="page">
            <option value="/">Accueil</option>
            <option value="/table">Tableau</option>
            <option value="/graph">Graphique</option>
            <option value="/text">Texte</option>
        </select>
        <button type="submit">Aller à la page</button>
    </form>
    <div>
        <p>Mean price per GB for SSDs: {{ssd_mean_price_per_gb}} €/GB</p>
        <p>Mean price per GB for HDDs: {{hdd_mean_price_per_gb}} €/GB</p>
		<p>Mean rating for SSDs: {{ssd_mean_rating}}</p>
		<p>Mean rating for HDDs: {{hdd_mean_rating}}</p>
    </div>
	<div id="plot"></div>
	<script>
		var hdd_price_per_gb = [];
		var hdd_storage = [];
		var ssd_price_per_gb = [];
		var ssd_storage = [];
		{% for doc in data %}
		    {% if doc['keyword'] == 'HDD' %}
		        hdd_price_per_gb.push({{ doc['price'] }} / {{ doc['harmonized_capacity'] }});
		        hdd_storage.push({{ doc['harmonized_capacity'] }});
		    {% elif doc['keyword'] == 'SSD' %}
		        ssd_price_per_gb.push({{ doc['price'] }} / {{ doc['harmonized_capacity'] }});
		        ssd_storage.push({{ doc['harmonized_capacity'] }});
		    {% endif %}
		{% endfor %}
		var data = [
			{
				y: hdd_price_per_gb,
				x: hdd_storage,
				type: 'scatter',
				name: 'HDD'
			},
			{
				y: ssd_price_per_gb,
				x: ssd_storage,
				type: 'scatter',
				name: 'SSD'
			}
		];
		var layout = {
			title: 'Comparaison du prix par Go entre les disques durs et les SSD',
			xaxis: {
				title: 'Stockage (en Go)',
				showgrid: true,
				zeroline: false
			},
			yaxis: {
				title: 'Prix par Go (en euros)',
				showline: true
			}
		};
		Plotly.newPlot('plot', data, layout);
	</script>
	<div id="bar-plot"></div>
	<script>
		var hdd_price_per_gb = [];
		var hdd_mean_rating = [];
		var ssd_price_per_gb = [];
		var ssd_mean_rating = [];
	{% for doc in data %}
		{% if doc['keyword'] == 'HDD' %}
			hdd_price_per_gb.push({{ doc['price'] }} / {{ doc['harmonized_capacity'] }});
			hdd_mean_rating.push({{ doc['stars'] }});
		{% elif doc['keyword'] == 'SSD' %}
			ssd_price_per_gb.push({{ doc['price'] }} / {{ doc['harmonized_capacity'] }});
			ssd_mean_rating.push({{ doc['stars'] }});
		{% endif %}
	{% endfor %}
	var hdd_data = [    		{        			x: hdd_price_per_gb,        			y: hdd_mean_rating,        			type: 'bar',        			name: 'HDD'    		}	];
	var ssd_data = [    		{        			x: ssd_price_per_gb,        			y: ssd_mean_rating,        			type: 'bar',        			name: 'SSD'    		}	];
	var layout = {
		title: 'Moyenne des évaluations en fonction du prix par Go',
		xaxis: {
			title: 'Prix par Go (en euros)',
			showgrid: true,
			zeroline: false
		},
		yaxis: {
			title: 'Moyenne des évaluations',
			showline: true
		},
		barmode: 'group',
	};
	Plotly.newPlot('bar-plot', hdd_data.concat(ssd_data), layout);
	</script>
</body>
</html>
